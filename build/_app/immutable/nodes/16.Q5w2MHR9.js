import{S as yt,i as mt,s as bt,n as ve,d as u,b as C,p,y as kt,h as I,e as d,f as y,k as P,j as f,l as gt,v as qt,D as lt,A as ht,q as N,w as vt,a as te,c as o,g as B,t as R,u as Ae,r as Fe,o as K,m as G,z as we,B as _t}from"../chunks/BOFvEgh9.js";import{e as Le}from"../chunks/D6YF6ztN.js";import"../chunks/IHki7fMi.js";import{g as it}from"../chunks/Bl12ujJP.js";import{p as Ct}from"../chunks/DoBB0Fpi.js";function st(i,e,t){const l=i.slice();return l[25]=e[t][0],l[26]=e[t][1],l}function at(i,e,t){const l=i.slice();return l[29]=e[t],l[30]=e,l[31]=t,l}function Et(i){let e,t='<h1 class="svelte-iqlzcp">Policy Not Found</h1> <p class="svelte-iqlzcp">The requested policy could not be found.</p> <a href="/policy" class="btn primary svelte-iqlzcp">‚Üê Back to Policies</a>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(l){e=d(l,"DIV",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-nsfys1"&&(e.innerHTML=t),this.h()},h(){p(e,"class","error-state svelte-iqlzcp")},m(l,s){C(l,e,s)},p:ve,d(l){l&&u(e)}}}function zt(i){let e,t,l,s,a="üõ°Ô∏è Policies",n,c,h=i[0].name+"",r,_,v,m,g,D=i[0].name+"",q,j,V,E,w=i[0].enabled?"ENABLED":"DISABLED",W,Q,L,F,X,O,z=i[0].policyId+"",M,b,S,U,le,ee=i[0].description+"",se,be,Z,ie,ne,Ue="Basic Settings",Oe,Me,Y,oe,He="Policy Rules",Te,ke,Ve=Object.keys(i[0].policy).length===0,Ne,ae,re,Je="Raw Policy JSON",Be,ue,pe,ye,me=JSON.stringify(i[2]?i[4].policy:i[0].policy,null,2)+"",ge;function Qe(k,T){return k[2]?Pt:It}let qe=Qe(i),x=qe(i);function Xe(k,T){return k[2]?Lt:wt}let Ce=Xe(i),$=Ce(i),de=Le(Object.entries(i[5])),H=[];for(let k=0;k<de.length;k+=1)H[k]=ct(st(i,de,k));let J=Ve&&ut(i);return{c(){e=f("div"),t=f("div"),l=f("div"),s=f("a"),s.textContent=a,n=R(" / "),c=f("span"),r=R(h),_=P(),v=f("div"),m=f("div"),g=f("h1"),q=R(D),j=P(),V=f("div"),E=f("span"),W=R(w),L=P(),F=f("span"),X=R("ID: "),O=f("code"),M=R(z),b=P(),S=f("div"),x.c(),U=P(),le=f("p"),se=R(ee),be=P(),Z=f("div"),ie=f("div"),ne=f("h2"),ne.textContent=Ue,Oe=P(),$.c(),Me=P(),Y=f("div"),oe=f("h2"),oe.textContent=He,Te=P();for(let k=0;k<H.length;k+=1)H[k].c();ke=P(),J&&J.c(),Ne=P(),ae=f("div"),re=f("h2"),re.textContent=Je,Be=P(),ue=f("div"),pe=f("pre"),ye=f("code"),ge=R(me),this.h()},l(k){e=d(k,"DIV",{class:!0});var T=y(e);t=d(T,"DIV",{class:!0});var A=y(t);l=d(A,"DIV",{class:!0});var ce=y(l);s=d(ce,"A",{href:!0,class:!0,"data-svelte-h":!0}),N(s)!=="svelte-1f107oy"&&(s.textContent=a),n=B(ce," / "),c=d(ce,"SPAN",{class:!0});var Ge=y(c);r=B(Ge,h),Ge.forEach(u),ce.forEach(u),_=I(A),v=d(A,"DIV",{class:!0});var Ee=y(v);m=d(Ee,"DIV",{class:!0});var ze=y(m);g=d(ze,"H1",{class:!0});var Ke=y(g);q=B(Ke,D),Ke.forEach(u),j=I(ze),V=d(ze,"DIV",{class:!0});var De=y(V);E=d(De,"SPAN",{class:!0});var We=y(E);W=B(We,w),We.forEach(u),L=I(De),F=d(De,"SPAN",{class:!0});var Re=y(F);X=B(Re,"ID: "),O=d(Re,"CODE",{class:!0});var Ye=y(O);M=B(Ye,z),Ye.forEach(u),Re.forEach(u),De.forEach(u),ze.forEach(u),b=I(Ee),S=d(Ee,"DIV",{class:!0});var Ze=y(S);x.l(Ze),Ze.forEach(u),Ee.forEach(u),U=I(A),le=d(A,"P",{class:!0});var xe=y(le);se=B(xe,ee),xe.forEach(u),A.forEach(u),T.forEach(u),be=I(k),Z=d(k,"DIV",{class:!0});var fe=y(Z);ie=d(fe,"DIV",{class:!0});var Ie=y(ie);ne=d(Ie,"H2",{class:!0,"data-svelte-h":!0}),N(ne)!=="svelte-11d4akh"&&(ne.textContent=Ue),Oe=I(Ie),$.l(Ie),Ie.forEach(u),Me=I(fe),Y=d(fe,"DIV",{class:!0});var he=y(Y);oe=d(he,"H2",{class:!0,"data-svelte-h":!0}),N(oe)!=="svelte-qvhyiz"&&(oe.textContent=He),Te=I(he);for(let je=0;je<H.length;je+=1)H[je].l(he);ke=I(he),J&&J.l(he),he.forEach(u),Ne=I(fe),ae=d(fe,"DIV",{class:!0});var Pe=y(ae);re=d(Pe,"H2",{class:!0,"data-svelte-h":!0}),N(re)!=="svelte-1o2yblc"&&(re.textContent=Je),Be=I(Pe),ue=d(Pe,"DIV",{class:!0});var $e=y(ue);pe=d($e,"PRE",{class:!0});var et=y(pe);ye=d(et,"CODE",{});var tt=y(ye);ge=B(tt,me),tt.forEach(u),et.forEach(u),$e.forEach(u),Pe.forEach(u),fe.forEach(u),this.h()},h(){p(s,"href","/policy"),p(s,"class","svelte-iqlzcp"),p(c,"class","svelte-iqlzcp"),p(l,"class","breadcrumb svelte-iqlzcp"),p(g,"class","svelte-iqlzcp"),p(E,"class",Q="status "+ft(i[0].enabled)+" svelte-iqlzcp"),p(O,"class","svelte-iqlzcp"),p(F,"class","policy-id svelte-iqlzcp"),p(V,"class","policy-meta svelte-iqlzcp"),p(m,"class","policy-title svelte-iqlzcp"),p(S,"class","header-actions svelte-iqlzcp"),p(v,"class","policy-header svelte-iqlzcp"),p(le,"class","policy-description svelte-iqlzcp"),p(t,"class","header-content"),p(e,"class","header-section svelte-iqlzcp"),p(ne,"class","svelte-iqlzcp"),p(ie,"class","section svelte-iqlzcp"),p(oe,"class","svelte-iqlzcp"),p(Y,"class","section svelte-iqlzcp"),p(re,"class","svelte-iqlzcp"),p(pe,"class","svelte-iqlzcp"),p(ue,"class","json-view svelte-iqlzcp"),p(ae,"class","section svelte-iqlzcp"),p(Z,"class","policy-content svelte-iqlzcp")},m(k,T){C(k,e,T),o(e,t),o(t,l),o(l,s),o(l,n),o(l,c),o(c,r),o(t,_),o(t,v),o(v,m),o(m,g),o(g,q),o(m,j),o(m,V),o(V,E),o(E,W),o(V,L),o(V,F),o(F,X),o(F,O),o(O,M),o(v,b),o(v,S),x.m(S,null),o(t,U),o(t,le),o(le,se),C(k,be,T),C(k,Z,T),o(Z,ie),o(ie,ne),o(ie,Oe),$.m(ie,null),o(Z,Me),o(Z,Y),o(Y,oe),o(Y,Te);for(let A=0;A<H.length;A+=1)H[A]&&H[A].m(Y,null);o(Y,ke),J&&J.m(Y,null),o(Z,Ne),o(Z,ae),o(ae,re),o(ae,Be),o(ae,ue),o(ue,pe),o(pe,ye),o(ye,ge)},p(k,T){if(T[0]&1&&h!==(h=k[0].name+"")&&te(r,h),T[0]&1&&D!==(D=k[0].name+"")&&te(q,D),T[0]&1&&w!==(w=k[0].enabled?"ENABLED":"DISABLED")&&te(W,w),T[0]&1&&Q!==(Q="status "+ft(k[0].enabled)+" svelte-iqlzcp")&&p(E,"class",Q),T[0]&1&&z!==(z=k[0].policyId+"")&&te(M,z),qe===(qe=Qe(k))&&x?x.p(k,T):(x.d(1),x=qe(k),x&&(x.c(),x.m(S,null))),T[0]&1&&ee!==(ee=k[0].description+"")&&te(se,ee),Ce===(Ce=Xe(k))&&$?$.p(k,T):($.d(1),$=Ce(k),$&&($.c(),$.m(ie,null))),T[0]&1589){de=Le(Object.entries(k[5]));let A;for(A=0;A<de.length;A+=1){const ce=st(k,de,A);H[A]?H[A].p(ce,T):(H[A]=ct(ce),H[A].c(),H[A].m(Y,ke))}for(;A<H.length;A+=1)H[A].d(1);H.length=de.length}T[0]&1&&(Ve=Object.keys(k[0].policy).length===0),Ve?J?J.p(k,T):(J=ut(k),J.c(),J.m(Y,null)):J&&(J.d(1),J=null),T[0]&21&&me!==(me=JSON.stringify(k[2]?k[4].policy:k[0].policy,null,2)+"")&&te(ge,me)},d(k){k&&(u(e),u(be),u(Z)),x.d(),$.d(),vt(H,k),J&&J.d()}}}function Dt(i){let e,t='<div class="spinner large svelte-iqlzcp">‚ö™</div> <p class="svelte-iqlzcp">Loading policy details...</p>';return{c(){e=f("div"),e.innerHTML=t,this.h()},l(l){e=d(l,"DIV",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-171mz7i"&&(e.innerHTML=t),this.h()},h(){p(e,"class","loading-state svelte-iqlzcp")},m(l,s){C(l,e,s)},p:ve,d(l){l&&u(e)}}}function It(i){let e,t="‚úèÔ∏è Edit Policy",l,s,a="üóëÔ∏è Delete",n,c;return{c(){e=f("button"),e.textContent=t,l=P(),s=f("button"),s.textContent=a,this.h()},l(h){e=d(h,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-15sr7im"&&(e.textContent=t),l=I(h),s=d(h,"BUTTON",{class:!0,"data-svelte-h":!0}),N(s)!=="svelte-afkcvf"&&(s.textContent=a),this.h()},h(){p(e,"class","btn secondary svelte-iqlzcp"),p(s,"class","btn danger svelte-iqlzcp")},m(h,r){C(h,e,r),C(h,l,r),C(h,s,r),n||(c=[K(e,"click",i[12]),K(s,"click",i[7])],n=!0)},p:ve,d(h){h&&(u(e),u(l),u(s)),n=!1,Fe(c)}}}function Pt(i){let e,t,l,s,a,n;function c(_,v){return _[3]?At:St}let h=c(i),r=h(i);return{c(){e=f("button"),t=R("Cancel"),l=P(),s=f("button"),r.c(),this.h()},l(_){e=d(_,"BUTTON",{class:!0});var v=y(e);t=B(v,"Cancel"),v.forEach(u),l=I(_),s=d(_,"BUTTON",{class:!0});var m=y(s);r.l(m),m.forEach(u),this.h()},h(){p(e,"class","btn secondary svelte-iqlzcp"),e.disabled=i[3],p(s,"class","btn primary svelte-iqlzcp"),s.disabled=i[3]},m(_,v){C(_,e,v),o(e,t),C(_,l,v),C(_,s,v),r.m(s,null),a||(n=[K(e,"click",i[8]),K(s,"click",i[6])],a=!0)},p(_,v){v[0]&8&&(e.disabled=_[3]),h!==(h=c(_))&&(r.d(1),r=h(_),r&&(r.c(),r.m(s,null))),v[0]&8&&(s.disabled=_[3])},d(_){_&&(u(e),u(l),u(s)),r.d(),a=!1,Fe(n)}}}function St(i){let e;return{c(){e=R("Save Changes")},l(t){e=B(t,"Save Changes")},m(t,l){C(t,e,l)},d(t){t&&u(e)}}}function At(i){let e,t="‚ö™",l;return{c(){e=f("span"),e.textContent=t,l=R(`
                  Saving...`),this.h()},l(s){e=d(s,"SPAN",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-156g31a"&&(e.textContent=t),l=B(s,`
                  Saving...`),this.h()},h(){p(e,"class","spinner svelte-iqlzcp")},m(s,a){C(s,e,a),C(s,l,a)},d(s){s&&(u(e),u(l))}}}function wt(i){let e,t,l,s="Created",a,n,c=Se(i[0].createdAt)+"",h,r,_,v,m="Last Updated",g,D,q=Se(i[0].updatedAt)+"",j,V,E,w,W="Rules Count",Q,L,F=Object.keys(i[0].policy).length+"",X,O;return{c(){e=f("div"),t=f("div"),l=f("label"),l.textContent=s,a=P(),n=f("span"),h=R(c),r=P(),_=f("div"),v=f("label"),v.textContent=m,g=P(),D=f("span"),j=R(q),V=P(),E=f("div"),w=f("label"),w.textContent=W,Q=P(),L=f("span"),X=R(F),O=R(" rules configured"),this.h()},l(z){e=d(z,"DIV",{class:!0});var M=y(e);t=d(M,"DIV",{class:!0});var b=y(t);l=d(b,"LABEL",{class:!0,"data-svelte-h":!0}),N(l)!=="svelte-39aswo"&&(l.textContent=s),a=I(b),n=d(b,"SPAN",{class:!0});var S=y(n);h=B(S,c),S.forEach(u),b.forEach(u),r=I(M),_=d(M,"DIV",{class:!0});var U=y(_);v=d(U,"LABEL",{class:!0,"data-svelte-h":!0}),N(v)!=="svelte-1mmseot"&&(v.textContent=m),g=I(U),D=d(U,"SPAN",{class:!0});var le=y(D);j=B(le,q),le.forEach(u),U.forEach(u),V=I(M),E=d(M,"DIV",{class:!0});var ee=y(E);w=d(ee,"LABEL",{class:!0,"data-svelte-h":!0}),N(w)!=="svelte-1i5bluw"&&(w.textContent=W),Q=I(ee),L=d(ee,"SPAN",{class:!0});var se=y(L);X=B(se,F),O=B(se," rules configured"),se.forEach(u),ee.forEach(u),M.forEach(u),this.h()},h(){p(l,"class","svelte-iqlzcp"),p(n,"class","svelte-iqlzcp"),p(t,"class","info-item svelte-iqlzcp"),p(v,"class","svelte-iqlzcp"),p(D,"class","svelte-iqlzcp"),p(_,"class","info-item svelte-iqlzcp"),p(w,"class","svelte-iqlzcp"),p(L,"class","svelte-iqlzcp"),p(E,"class","info-item svelte-iqlzcp"),p(e,"class","info-grid svelte-iqlzcp")},m(z,M){C(z,e,M),o(e,t),o(t,l),o(t,a),o(t,n),o(n,h),o(e,r),o(e,_),o(_,v),o(_,g),o(_,D),o(D,j),o(e,V),o(e,E),o(E,w),o(E,Q),o(E,L),o(L,X),o(L,O)},p(z,M){M[0]&1&&c!==(c=Se(z[0].createdAt)+"")&&te(h,c),M[0]&1&&q!==(q=Se(z[0].updatedAt)+"")&&te(j,q),M[0]&1&&F!==(F=Object.keys(z[0].policy).length+"")&&te(X,F)},d(z){z&&u(e)}}}function Lt(i){let e,t,l,s="Policy Name",a,n,c,h,r,_="Status",v,m,g,D="Enabled",q,j="Disabled",V,E,w,W="Description",Q,L,F,X;return{c(){e=f("div"),t=f("div"),l=f("label"),l.textContent=s,a=P(),n=f("input"),c=P(),h=f("div"),r=f("label"),r.textContent=_,v=P(),m=f("select"),g=f("option"),g.textContent=D,q=f("option"),q.textContent=j,V=P(),E=f("div"),w=f("label"),w.textContent=W,Q=P(),L=f("textarea"),this.h()},l(O){e=d(O,"DIV",{class:!0});var z=y(e);t=d(z,"DIV",{class:!0});var M=y(t);l=d(M,"LABEL",{class:!0,"data-svelte-h":!0}),N(l)!=="svelte-3ojcud"&&(l.textContent=s),a=I(M),n=d(M,"INPUT",{type:!0,class:!0}),M.forEach(u),c=I(z),h=d(z,"DIV",{class:!0});var b=y(h);r=d(b,"LABEL",{class:!0,"data-svelte-h":!0}),N(r)!=="svelte-akrz1q"&&(r.textContent=_),v=I(b),m=d(b,"SELECT",{class:!0});var S=y(m);g=d(S,"OPTION",{"data-svelte-h":!0}),N(g)!=="svelte-9v0opp"&&(g.textContent=D),q=d(S,"OPTION",{"data-svelte-h":!0}),N(q)!=="svelte-17vl8k9"&&(q.textContent=j),S.forEach(u),b.forEach(u),V=I(z),E=d(z,"DIV",{class:!0});var U=y(E);w=d(U,"LABEL",{class:!0,"data-svelte-h":!0}),N(w)!=="svelte-yaz8sq"&&(w.textContent=W),Q=I(U),L=d(U,"TEXTAREA",{rows:!0,class:!0}),y(L).forEach(u),U.forEach(u),z.forEach(u),this.h()},h(){p(l,"class","svelte-iqlzcp"),p(n,"type","text"),p(n,"class","svelte-iqlzcp"),p(t,"class","form-group svelte-iqlzcp"),p(r,"class","svelte-iqlzcp"),g.__value=!0,G(g,g.__value),q.__value=!1,G(q,q.__value),p(m,"class","svelte-iqlzcp"),i[4].enabled===void 0&&_t(()=>i[14].call(m)),p(h,"class","form-group svelte-iqlzcp"),p(w,"class","svelte-iqlzcp"),p(L,"rows","3"),p(L,"class","svelte-iqlzcp"),p(E,"class","form-group full-width svelte-iqlzcp"),p(e,"class","form-grid svelte-iqlzcp")},m(O,z){C(O,e,z),o(e,t),o(t,l),o(t,a),o(t,n),G(n,i[4].name),o(e,c),o(e,h),o(h,r),o(h,v),o(h,m),o(m,g),o(m,q),we(m,i[4].enabled,!0),o(e,V),o(e,E),o(E,w),o(E,Q),o(E,L),G(L,i[4].description),F||(X=[K(n,"input",i[13]),K(m,"change",i[14]),K(L,"input",i[15])],F=!0)},p(O,z){z[0]&16&&n.value!==O[4].name&&G(n,O[4].name),z[0]&16&&we(m,O[4].enabled),z[0]&16&&G(L,O[4].description)},d(O){O&&u(e),F=!1,Fe(X)}}}function nt(i){let e,t,l=i[25]+"",s,a,n,c=Le(i[26]),h=[];for(let r=0;r<c.length;r+=1)h[r]=rt(at(i,c,r));return{c(){e=f("div"),t=f("h3"),s=R(l),a=P(),n=f("div");for(let r=0;r<h.length;r+=1)h[r].c();this.h()},l(r){e=d(r,"DIV",{class:!0});var _=y(e);t=d(_,"H3",{class:!0});var v=y(t);s=B(v,l),v.forEach(u),a=I(_),n=d(_,"DIV",{class:!0});var m=y(n);for(let g=0;g<h.length;g+=1)h[g].l(m);m.forEach(u),_.forEach(u),this.h()},h(){p(t,"class","svelte-iqlzcp"),p(n,"class","rules-grid svelte-iqlzcp"),p(e,"class","rule-category svelte-iqlzcp")},m(r,_){C(r,e,_),o(e,t),o(t,s),o(e,a),o(e,n);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(n,null)},p(r,_){if(_[0]&1589){c=Le(r[26]);let v;for(v=0;v<c.length;v+=1){const m=at(r,c,v);h[v]?h[v].p(m,_):(h[v]=rt(m),h[v].c(),h[v].m(n,null))}for(;v<h.length;v+=1)h[v].d(1);h.length=c.length}},d(r){r&&u(e),vt(h,r)}}}function ot(i){let e,t,l,s=i[29].label+"",a,n,c,h=i[29].description+"",r,_;function v(D,q){return D[2]?Mt:Ot}let m=v(i),g=m(i);return{c(){e=f("div"),t=f("div"),l=f("label"),a=R(s),n=P(),c=f("span"),r=R(h),_=P(),g.c(),this.h()},l(D){e=d(D,"DIV",{class:!0});var q=y(e);t=d(q,"DIV",{class:!0});var j=y(t);l=d(j,"LABEL",{class:!0});var V=y(l);a=B(V,s),V.forEach(u),n=I(j),c=d(j,"SPAN",{class:!0});var E=y(c);r=B(E,h),E.forEach(u),j.forEach(u),_=I(q),g.l(q),q.forEach(u),this.h()},h(){p(l,"class","svelte-iqlzcp"),p(c,"class","rule-description svelte-iqlzcp"),p(t,"class","rule-header svelte-iqlzcp"),p(e,"class","rule-item svelte-iqlzcp")},m(D,q){C(D,e,q),o(e,t),o(t,l),o(l,a),o(t,n),o(t,c),o(c,r),o(e,_),g.m(e,null)},p(D,q){m===(m=v(D))&&g?g.p(D,q):(g.d(1),g=m(D),g&&(g.c(),g.m(e,null)))},d(D){D&&u(e),g.d()}}}function Ot(i){let e,t,l=_e(i[0].policy[i[29].key])+"",s;return{c(){e=f("div"),t=f("code"),s=R(l),this.h()},l(a){e=d(a,"DIV",{class:!0});var n=y(e);t=d(n,"CODE",{class:!0});var c=y(t);s=B(c,l),c.forEach(u),n.forEach(u),this.h()},h(){p(t,"class","svelte-iqlzcp"),p(e,"class","rule-value svelte-iqlzcp")},m(a,n){C(a,e,n),o(e,t),o(t,s)},p(a,n){n[0]&1&&l!==(l=_e(a[0].policy[a[29].key])+"")&&te(s,l)},d(a){a&&u(e)}}}function Mt(i){let e;function t(a,n){return a[29].type==="boolean"?Rt:a[29].type==="number"?Bt:a[29].type==="array"?Nt:a[29].type==="object"?Vt:Tt}let s=t(i)(i);return{c(){e=f("div"),s.c(),this.h()},l(a){e=d(a,"DIV",{class:!0});var n=y(e);s.l(n),n.forEach(u),this.h()},h(){p(e,"class","rule-input svelte-iqlzcp")},m(a,n){C(a,e,n),s.m(e,null)},p(a,n){s.p(a,n)},d(a){a&&u(e),s.d()}}}function Tt(i){let e,t,l;function s(){i[20].call(e,i[29])}return{c(){e=f("input"),this.h()},l(a){e=d(a,"INPUT",{type:!0,class:!0}),this.h()},h(){p(e,"type","text"),p(e,"class","svelte-iqlzcp")},m(a,n){C(a,e,n),G(e,i[4].policy[i[29].key]),t||(l=K(e,"input",s),t=!0)},p(a,n){i=a,n[0]&48&&e.value!==i[4].policy[i[29].key]&&G(e,i[4].policy[i[29].key])},d(a){a&&u(e),t=!1,l()}}}function Vt(i){let e,t,l,s;function a(...n){return i[19](i[29],...n)}return{c(){e=f("textarea"),this.h()},l(n){e=d(n,"TEXTAREA",{rows:!0,placeholder:!0,class:!0}),y(e).forEach(u),this.h()},h(){e.value=t=_e(i[4].policy[i[29].key]||{}),p(e,"rows","3"),p(e,"placeholder","JSON object"),p(e,"class","svelte-iqlzcp")},m(n,c){C(n,e,c),l||(s=K(e,"input",a),l=!0)},p(n,c){i=n,c[0]&16&&t!==(t=_e(i[4].policy[i[29].key]||{}))&&(e.value=t)},d(n){n&&u(e),l=!1,s()}}}function Nt(i){let e,t,l,s;function a(...n){return i[18](i[29],...n)}return{c(){e=f("input"),this.h()},l(n){e=d(n,"INPUT",{type:!0,placeholder:!0,class:!0}),this.h()},h(){p(e,"type","text"),e.value=t=_e(i[4].policy[i[29].key]||[]),p(e,"placeholder","Comma-separated values"),p(e,"class","svelte-iqlzcp")},m(n,c){C(n,e,c),l||(s=K(e,"input",a),l=!0)},p(n,c){i=n,c[0]&16&&t!==(t=_e(i[4].policy[i[29].key]||[]))&&e.value!==t&&(e.value=t)},d(n){n&&u(e),l=!1,s()}}}function Bt(i){let e,t,l;function s(){i[17].call(e,i[29])}return{c(){e=f("input"),this.h()},l(a){e=d(a,"INPUT",{type:!0,class:!0}),this.h()},h(){p(e,"type","number"),p(e,"class","svelte-iqlzcp")},m(a,n){C(a,e,n),G(e,i[4].policy[i[29].key]),t||(l=K(e,"input",s),t=!0)},p(a,n){i=a,n[0]&48&&ht(e.value)!==i[4].policy[i[29].key]&&G(e,i[4].policy[i[29].key])},d(a){a&&u(e),t=!1,l()}}}function Rt(i){let e,t,l="True",s,a="False",n,c,h,r;function _(){i[16].call(e,i[29])}return{c(){e=f("select"),t=f("option"),t.textContent=l,s=f("option"),s.textContent=a,n=f("option"),c=R("Not Set"),this.h()},l(v){e=d(v,"SELECT",{class:!0});var m=y(e);t=d(m,"OPTION",{"data-svelte-h":!0}),N(t)!=="svelte-1wpj7a"&&(t.textContent=l),s=d(m,"OPTION",{"data-svelte-h":!0}),N(s)!=="svelte-1v2w52"&&(s.textContent=a),n=d(m,"OPTION",{});var g=y(n);c=B(g,"Not Set"),g.forEach(u),m.forEach(u),this.h()},h(){t.__value=!0,G(t,t.__value),s.__value=!1,G(s,s.__value),n.__value=void 0,G(n,n.__value),p(e,"class","svelte-iqlzcp"),i[4].policy[i[29].key]===void 0&&_t(_)},m(v,m){C(v,e,m),o(e,t),o(e,s),o(e,n),o(n,c),we(e,i[4].policy[i[29].key],!0),h||(r=K(e,"change",_),h=!0)},p(v,m){i=v,m[0]&48&&we(e,i[4].policy[i[29].key])},d(v){v&&u(e),h=!1,r()}}}function rt(i){let e=i[0].policy.hasOwnProperty(i[29].key)||i[2],t,l=e&&ot(i);return{c(){l&&l.c(),t=Ae()},l(s){l&&l.l(s),t=Ae()},m(s,a){l&&l.m(s,a),C(s,t,a)},p(s,a){a[0]&5&&(e=s[0].policy.hasOwnProperty(s[29].key)||s[2]),e?l?l.p(s,a):(l=ot(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&u(t),l&&l.d(s)}}}function ct(i){let e=i[26].some(i[11]),t,l=e&&nt(i);return{c(){l&&l.c(),t=Ae()},l(s){l&&l.l(s),t=Ae()},m(s,a){l&&l.m(s,a),C(s,t,a)},p(s,a){a[0]&5&&(e=s[26].some(s[11])),e?l?l.p(s,a):(l=nt(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&u(t),l&&l.d(s)}}}function ut(i){let e,t,l="No rules configured for this policy.",s,a=!i[2]&&pt(i);return{c(){e=f("div"),t=f("p"),t.textContent=l,s=P(),a&&a.c(),this.h()},l(n){e=d(n,"DIV",{class:!0});var c=y(e);t=d(c,"P",{"data-svelte-h":!0}),N(t)!=="svelte-1vtgjgv"&&(t.textContent=l),s=I(c),a&&a.l(c),c.forEach(u),this.h()},h(){p(e,"class","empty-rules svelte-iqlzcp")},m(n,c){C(n,e,c),o(e,t),o(e,s),a&&a.m(e,null)},p(n,c){n[2]?a&&(a.d(1),a=null):a?a.p(n,c):(a=pt(n),a.c(),a.m(e,null))},d(n){n&&u(e),a&&a.d()}}}function pt(i){let e,t="Configure Rules",l,s;return{c(){e=f("button"),e.textContent=t,this.h()},l(a){e=d(a,"BUTTON",{class:!0,"data-svelte-h":!0}),N(e)!=="svelte-ovxfsx"&&(e.textContent=t),this.h()},h(){p(e,"class","btn primary svelte-iqlzcp")},m(a,n){C(a,e,n),l||(s=K(e,"click",i[21]),l=!0)},p:ve,d(a){a&&u(e),l=!1,s()}}}function jt(i){let e,t,l;document.title=e=(i[0]?i[0].name:"Loading...")+" - Policy Details";function s(c,h){return c[1]?Dt:c[0]?zt:Et}let a=s(i),n=a(i);return{c(){t=P(),l=f("div"),n.c(),this.h()},l(c){kt("svelte-1r6g64e",document.head).forEach(u),t=I(c),l=d(c,"DIV",{class:!0});var r=y(l);n.l(r),r.forEach(u),this.h()},h(){p(l,"class","policy-detail svelte-iqlzcp")},m(c,h){C(c,t,h),C(c,l,h),n.m(l,null)},p(c,h){h[0]&1&&e!==(e=(c[0]?c[0].name:"Loading...")+" - Policy Details")&&(document.title=e),a===(a=s(c))&&n?n.p(c,h):(n.d(1),n=a(c),n&&(n.c(),n.m(l,null)))},i:ve,o:ve,d(c){c&&(u(t),u(l)),n.d()}}}function dt(i){return{pol_001:{policyId:"pol_001",name:"Production Data Access",description:"Standard access controls for production datasets",enabled:!0,createdAt:new Date(Date.now()-6048e5).toISOString(),updatedAt:new Date(Date.now()-1728e5).toISOString(),type:"access_control",policy:{minConfs:6,classificationAllowList:["public","internal"],allowRecalled:!1,maxLineageDepth:10,minProducerUptime:95,maxDataAgeSeconds:2592e3}},pol_002:{policyId:"pol_002",name:"PII Protection Policy",description:"Privacy controls for personally identifiable information",enabled:!0,createdAt:new Date(Date.now()-12096e5).toISOString(),updatedAt:new Date(Date.now()-864e5).toISOString(),type:"privacy",policy:{minConfs:6,allowRecalled:!1,piiFlagsBlockList:["has_personal_info","has_contact_details"],minAnonymizationLevel:{type:"k-anon",k:5},blockIfInThreatFeed:!0,requiresBillingAccount:!0}},pol_003:{policyId:"pol_003",name:"ML Model Validation",description:"Quality and bias checks for machine learning models",enabled:!1,createdAt:new Date(Date.now()-18144e5).toISOString(),updatedAt:new Date(Date.now()-432e6).toISOString(),type:"mlops",policy:{minConfs:6,allowRecalled:!1,maxBiasScore:.2,maxDriftScore:.15,requiresValidSplit:!0,minUniquenessRatio:.95,maxNullValuePercentage:5,requiredFeatureSetId:"ml-features-v2"}}}[i]||{policyId:i,name:"Unknown Policy",description:"Policy not found",enabled:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),type:"unknown",policy:{}}}function Se(i){return new Date(i).toLocaleString()}function _e(i){return Array.isArray(i)?i.join(", "):typeof i=="object"&&i!==null?JSON.stringify(i,null,2):String(i)}function ft(i){return i?"status-success":"status-error"}function Ft(i,e,t){let l;gt(i,Ct,b=>t(23,l=b));let s="",a=null,n=!1,c=!1,h=!1,r={name:"",description:"",enabled:!0,policy:{}};const _={"SPV & Confirmations":[{key:"minConfs",label:"Min Confirmations",type:"number",description:"Minimum SPV confirmations required"},{key:"allowRecalled",label:"Allow Recalled",type:"boolean",description:"Allow recalled/flagged data"}],"Producer & Provenance":[{key:"producerAllowList",label:"Producer Allow List",type:"array",description:"Allowed producer public keys"},{key:"producerBlockList",label:"Producer Block List",type:"array",description:"Blocked producer public keys"},{key:"maxLineageDepth",label:"Max Lineage Depth",type:"number",description:"Maximum allowed lineage depth"},{key:"requiredAncestor",label:"Required Ancestor",type:"string",description:"Required ancestor version ID"}],"Compliance & Legal":[{key:"classificationAllowList",label:"Classification Allow List",type:"array",description:"Allowed data classifications"},{key:"licenseAllowList",label:"License Allow List",type:"array",description:"Allowed data licenses"},{key:"piiFlagsBlockList",label:"PII Flags Block List",type:"array",description:"Blocked PII flag types"},{key:"geoOriginAllowList",label:"Geo Origin Allow List",type:"array",description:"Allowed geographic origins"}],"Content & Schema":[{key:"requiredSchemaHash",label:"Required Schema Hash",type:"string",description:"Required exact schema hash"},{key:"requiredMimeTypes",label:"Required MIME Types",type:"array",description:"Required MIME types"},{key:"requiredOntologyTags",label:"Required Ontology Tags",type:"array",description:"Required ontology tags"}],"Economics & Operations":[{key:"maxPricePerByte",label:"Max Price Per Byte",type:"number",description:"Maximum price per byte limit"},{key:"maxTotalCostForLineage",label:"Max Total Cost",type:"number",description:"Maximum total lineage cost"},{key:"maxDataAgeSeconds",label:"Max Data Age (seconds)",type:"number",description:"Maximum data age in seconds"},{key:"minProducerUptime",label:"Min Producer Uptime (%)",type:"number",description:"Minimum producer uptime percentage"},{key:"requiresBillingAccount",label:"Requires Billing Account",type:"boolean",description:"Billing account required"}],"Data Quality & Profiling":[{key:"minRowCount",label:"Min Row Count",type:"number",description:"Minimum number of rows"},{key:"maxRowCount",label:"Max Row Count",type:"number",description:"Maximum number of rows"},{key:"maxNullValuePercentage",label:"Max Null Value %",type:"number",description:"Maximum null value percentage"},{key:"requiredDistributionProfileHash",label:"Required Profile Hash",type:"string",description:"Required distribution profile hash"},{key:"maxOutlierScore",label:"Max Outlier Score",type:"number",description:"Maximum outlier score"},{key:"minUniquenessRatio",label:"Min Uniqueness Ratio",type:"number",description:"Minimum uniqueness ratio"}],"MLOps & Model Validation":[{key:"requiredFeatureSetId",label:"Required Feature Set ID",type:"string",description:"Required feature set identifier"},{key:"requiresValidSplit",label:"Requires Valid Split",type:"boolean",description:"Valid train/val/test split required"},{key:"maxBiasScore",label:"Max Bias Score",type:"number",description:"Maximum bias score allowed"},{key:"maxDriftScore",label:"Max Drift Score",type:"number",description:"Maximum drift score allowed"},{key:"requiredParentModelId",label:"Required Parent Model ID",type:"string",description:"Required parent model identifier"}],"Security & Privacy":[{key:"blockIfInThreatFeed",label:"Block If In Threat Feed",type:"boolean",description:"Block if found in threat feeds"},{key:"minAnonymizationLevel",label:"Min Anonymization Level",type:"object",description:"Minimum anonymization requirements"}]};qt(()=>{s=l.params.id,v()});async function v(){t(1,n=!0);try{try{const b=await fetch(`/policies/${s}`);b.ok?t(0,a=await b.json()):t(0,a=dt(s))}catch(b){console.warn("Policy API failed:",b),t(0,a=dt(s))}t(4,r={name:a.name,description:a.description,enabled:a.enabled,policy:{...a.policy}})}catch(b){console.error("Failed to load policy:",b),it("/policy")}finally{t(1,n=!1)}}async function m(){t(3,h=!0);try{await fetch(`/policies/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),t(0,a={...a,...r,updatedAt:new Date().toISOString()}),t(2,c=!1)}catch(b){console.error("Failed to save policy:",b),alert("Failed to save policy. Please try again.")}finally{t(3,h=!1)}}async function g(){if(confirm(`Are you sure you want to delete the policy "${a.name}"? This action cannot be undone.`))try{await fetch(`/policies/${s}`,{method:"DELETE"}),it("/policy")}catch(b){console.error("Failed to delete policy:",b),alert("Failed to delete policy. Please try again.")}}function D(){t(4,r={name:a.name,description:a.description,enabled:a.enabled,policy:{...a.policy}}),t(2,c=!1)}function q(b,S){typeof S=="string"?t(4,r.policy[b]=S.split(",").map(U=>U.trim()).filter(U=>U),r):t(4,r.policy[b]=S,r)}function j(b,S){try{t(4,r.policy[b]=JSON.parse(S),r)}catch{t(4,r.policy[b]=S,r)}}const V=b=>a.policy.hasOwnProperty(b.key)||c,E=()=>t(2,c=!0);function w(){r.name=this.value,t(4,r)}function W(){r.enabled=lt(this),t(4,r)}function Q(){r.description=this.value,t(4,r)}function L(b){r.policy[b.key]=lt(this),t(4,r)}function F(b){r.policy[b.key]=ht(this.value),t(4,r)}const X=(b,S)=>q(b.key,S.target.value),O=(b,S)=>j(b.key,S.target.value);function z(b){r.policy[b.key]=this.value,t(4,r)}return[a,n,c,h,r,_,m,g,D,q,j,V,E,w,W,Q,L,F,X,O,z,()=>t(2,c=!0)]}class Gt extends yt{constructor(e){super(),mt(this,e,Ft,jt,bt,{},null,[-1,-1])}}export{Gt as component};
