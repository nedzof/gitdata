# D022HR Pure PostgreSQL/Redis Implementation
# Modern hybrid database configuration (no SQLite legacy)

# ===== PostgreSQL Configuration =====
# Connection URL (recommended)
PG_URL=postgres://user:password@localhost:5432/overlay

# Individual parameters (alternative to PG_URL)
PG_HOST=localhost
PG_PORT=5432
PG_DATABASE=overlay
PG_USER=postgres
PG_PASSWORD=your_password
PG_SSL=false

# Connection pooling
PG_POOL_MIN=2
PG_POOL_MAX=20

# ===== Redis Configuration =====
# Connection URL (recommended)
REDIS_URL=redis://localhost:6379/0

# Individual parameters (alternative to REDIS_URL)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ===== Cache Configuration =====
# Enable Redis for bundle caching (D011HR)
USE_REDIS_BUNDLES=true

# Cache TTL settings (in milliseconds)
CACHE_TTLS_JSON={"headers":60000,"bundles":60000,"assets":300000,"listings":180000,"lineage":120000,"sessions":1800000,"policies":600000,"prices":120000}

# ===== OpenLineage Configuration =====
OL_QUERY_MAX_DEPTH=10
OL_QUERY_CACHE_TTL_SEC=120

# ===== Storage Configuration (D22) =====
STORAGE_BACKEND=s3
S3_ENDPOINT=
S3_BUCKET_HOT=
PRESIGN_TTL_SEC=900
CDN_MODE=direct
CDN_BASE_URL=

# ===== Feature Flags =====
FEATURE_FLAGS_JSON={"payments":true,"ingest":true,"bundle":true,"ready":true,"models":true,"lineage":true}

# ===== Bundle & Policy Configuration =====
BUNDLE_MAX_DEPTH=8
POLICY_MIN_CONFS=1
HEADERS_FILE=./data/headers.json
BUNDLE_VALIDATE=false

# ===== Price Configuration =====
PRICE_DEFAULT_SATS=1234
PRICE_QUOTE_TTL_SEC=120
RECEIPT_TTL_SEC=120

# ===== Server Configuration =====
NODE_ENV=production
PORT=8788
OVERLAY_URL=http://localhost:8788
BODY_SIZE_LIMIT=256kb

# ===== Agent Configuration =====
A2A_WORKER_ENABLED=true
AGENT_CALL_PRIVKEY=deadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeefdeadbeef
OVERLAY_PORT=8788

# ===== Required Services =====
# Ensure PostgreSQL and Redis are running before starting the application
# PostgreSQL: createdb overlay
# Redis: redis-server